"use strict";var f=require("path"),l=require("electron");require("path");const{statSync:y}=require("fs"),h=require("os"),d=require("fs"),m=h.platform()==="darwin",D=h.platform()==="win32",p=h.platform()==="linux";let C="\\",v="/",i;p?i=v:i=C;console.log("Operating system is:",p?"Linux":m?"Mac":D?"Windows":"");const b={}.npm_lifecycle_event==="app:dev";async function w(){const e=new l.BrowserWindow({width:800,height:600,webPreferences:{preload:f.join(__dirname,"../preload/preload.js"),nodeIntegration:!0,contextIsolation:!1}});l.ipcMain.on("getDrives",(u,n)=>{console.log("message from frontend:",JSON.parse(n)),(async()=>{let o=[];const s=await require("drivelist").list();try{console.log(s),s.forEach((r,c)=>{console.log(r.mountpoints[0],"b4"),typeof(r==null?void 0:r.mountpoints[0])!="undefined"&&o.push(r.mountpoints[0].path)}),console.log(o),e.webContents.send("backEndMsg",o)}catch(r){console.log(r)}})()}),l.ipcMain.on("setDirectory",(u,n)=>{var r;const t=require("os").homedir();let o="",g=[],s;console.log("initialDirectory: ",n);try{n.length>0?s=d==null?void 0:d.readdirSync(n):(s=d.readdirSync("C:\\"),n="C:\\"),console.log(s,"contents")}catch{}p||(o=`${t}\\Desktop`,console.log("desktop directory: ",o));for(let c in s)try{let a,q;console.log(n+i+s[c],"concat check"),(r=y(n+i+s[c]))!=null&&r.isDirectory()?(console.log("its a directory"),a=!0):a=!1,g.push({filename:s[c],isDirectory:a})}catch(a){console.log(a)}e.webContents.send("receiveDirectoryContents",{currentDirectory:n,currentDirectoryContents:g,desktop:o})}),l.ipcMain.on("upTheTree",(u,n)=>{const t=n.split(i);console.log(t.length,"directory string length");let o;if(console.log(t.length),!p&&t.length>=2&&(o=t.slice(0,t.length-1).join(i),console.log(o,"--new directory"),e.webContents.send("newDirectory",o)),p&&t.length>=3)o=t.slice(0,t.length-1).join(i),e.webContents.send("newDirectory",o);else return}),e==null||e.webContents.on("did-finish-load",()=>{e==null||e.webContents.send("main-process-message",new Date().toLocaleString())}),b?(e.loadURL("http://localhost:3000"),e.webContents.openDevTools()):e.loadFile(f.join(__dirname,"../../index.html"))}l.app.whenReady().then(()=>{w(),l.app.on("activate",function(){l.BrowserWindow.getAllWindows().length===0&&w()})});l.app.on("window-all-closed",()=>{process.platform!=="darwin"&&l.app.quit()});
